---
const { path } = Astro.props;
const adminlteJsUrl = path + "/js/adminlte.js";
---

<!--begin::Third Party Plugin(OverlayScrollbars)-->
<script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/browser/overlayscrollbars.browser.es6.min.js" integrity="sha256-dghWARbRe2eLlIJ56wNB+b760ywulqK3DzZYEpsg2fQ=" crossorigin="anonymous"></script>
<!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Required Plugin(popperjs for Bootstrap 5)-->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<!--end::Required Plugin(popperjs for Bootstrap 5)--><!--begin::Required Plugin(Bootstrap 5)-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
<!--end::Required Plugin(Bootstrap 5)--><!--begin::Required Plugin(AdminLTE)-->
<script src={adminlteJsUrl} is:inline></script>
<!--end::Required Plugin(AdminLTE)-->
<!--begin::OverlayScrollbars Configure-->


<script>


  document.addEventListener('DOMContentLoaded', () => {
  // Cierra otros dropdowns excepto el actual
  function closeOtherDropdowns(currentContent) {
    document.querySelectorAll('.dropdown-content.visible').forEach(el => {
      if (el !== currentContent && el.previousElementSibling) {
        el.classList.remove('visible');
        const arrow = el.previousElementSibling.querySelector('.arrow');
        if (arrow) arrow.classList.remove('rotated');
      }
    });
  }

  // Configura los botones de toggle
  document.querySelectorAll('.toggle-button').forEach(button => {
    button.addEventListener('click', (e) => {
      e.stopPropagation();
      const container = button.closest('.dropdown-container');
      if (!container) return;
      
      const arrow = button.querySelector('.arrow');
      const content = container.querySelector('.dropdown-content');
      if (!arrow || !content) return;

      closeOtherDropdowns(content);
      arrow.classList.toggle('rotated');
      content.classList.toggle('visible');
    });
  });


  // Cierra dropdowns al hacer clic fuera
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.dropdown-container')) {
      document.querySelectorAll('.dropdown-content.visible').forEach(content => {
        content.classList.remove('visible');
        if (content.previousElementSibling) {
          const arrow = content.previousElementSibling.querySelector('.arrow');
          if (arrow) arrow.classList.remove('rotated');
        }
      });
    }
  });
});
</script>


<script is:inline>
      
      const connectedSortables =
        document.querySelectorAll(".connectedSortable");
      connectedSortables.forEach((connectedSortable) => {
        let sortable = new Sortable(connectedSortable, {
          group: "shared",
          handle: ".card-header",
        });
      });

      const cardHeaders = document.querySelectorAll(
        ".connectedSortable .card-header",
      );
      cardHeaders.forEach((cardHeader) => {
        cardHeader.style.cursor = "move";
      });
    </script>


<script is:inline>
  const SELECTOR_SIDEBAR_WRAPPER = ".sidebar-wrapper";
  const Default = {
    scrollbarTheme: "os-theme-light",
    scrollbarAutoHide: "leave",
    scrollbarClickScroll: true,
  };
  document.addEventListener("DOMContentLoaded", function () {
    const sidebarWrapper = document.querySelector(SELECTOR_SIDEBAR_WRAPPER);
    if (
      sidebarWrapper &&
      typeof OverlayScrollbarsGlobal?.OverlayScrollbars !== "undefined"
    ) {
      OverlayScrollbarsGlobal.OverlayScrollbars(sidebarWrapper, {
        scrollbars: {
          theme: Default.scrollbarTheme,
          autoHide: Default.scrollbarAutoHide,
          clickScroll: Default.scrollbarClickScroll,
        },
      });
    }
  });
</script>

<script>
  // Mostrar/ocultar campo para nuevo tipo
  document.addEventListener("DOMContentLoaded", function () {
    const tipoSelect = document.getElementById("tipo");
    const nuevoTipoContainer = document.getElementById("nuevoTipoContainer");

    tipoSelect.addEventListener("change", function () {
      if (this.value === "otro") {
        nuevoTipoContainer.style.display = "block";
        document.getElementById("nuevoTipo").setAttribute("required", "required");
      } else {
        nuevoTipoContainer.style.display = "none";
        document.getElementById("nuevoTipo").removeAttribute("required");
      }
    });
  });
</script>

<!--end::OverlayScrollbars Configure-->
